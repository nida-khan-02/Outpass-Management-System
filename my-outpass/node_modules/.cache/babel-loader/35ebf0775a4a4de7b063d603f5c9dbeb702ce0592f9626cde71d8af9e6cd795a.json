{"ast":null,"code":"'use strict';\n\nmodule.exports = function stringifyFunctionOperators(pipeline) {\n  if (!Array.isArray(pipeline)) {\n    return;\n  }\n  for (const stage of pipeline) {\n    if (stage == null) {\n      continue;\n    }\n    const canHaveAccumulator = stage.$group || stage.$bucket || stage.$bucketAuto;\n    if (canHaveAccumulator != null) {\n      for (const key of Object.keys(canHaveAccumulator)) {\n        handleAccumulator(canHaveAccumulator[key]);\n      }\n    }\n    const stageType = Object.keys(stage)[0];\n    if (stageType && typeof stage[stageType] === 'object') {\n      const stageOptions = stage[stageType];\n      for (const key of Object.keys(stageOptions)) {\n        if (stageOptions[key] != null && stageOptions[key].$function != null && typeof stageOptions[key].$function.body === 'function') {\n          stageOptions[key].$function.body = stageOptions[key].$function.body.toString();\n        }\n      }\n    }\n    if (stage.$facet != null) {\n      for (const key of Object.keys(stage.$facet)) {\n        stringifyFunctionOperators(stage.$facet[key]);\n      }\n    }\n  }\n};\nfunction handleAccumulator(operator) {\n  if (operator == null || operator.$accumulator == null) {\n    return;\n  }\n  for (const key of ['init', 'accumulate', 'merge', 'finalize']) {\n    if (typeof operator.$accumulator[key] === 'function') {\n      operator.$accumulator[key] = String(operator.$accumulator[key]);\n    }\n  }\n}","map":{"version":3,"names":["module","exports","stringifyFunctionOperators","pipeline","Array","isArray","stage","canHaveAccumulator","$group","$bucket","$bucketAuto","key","Object","keys","handleAccumulator","stageType","stageOptions","$function","body","toString","$facet","operator","$accumulator","String"],"sources":["E:/Out/my-outpass/node_modules/mongoose/lib/helpers/aggregate/stringifyFunctionOperators.js"],"sourcesContent":["'use strict';\n\nmodule.exports = function stringifyFunctionOperators(pipeline) {\n  if (!Array.isArray(pipeline)) {\n    return;\n  }\n\n  for (const stage of pipeline) {\n    if (stage == null) {\n      continue;\n    }\n\n    const canHaveAccumulator = stage.$group || stage.$bucket || stage.$bucketAuto;\n    if (canHaveAccumulator != null) {\n      for (const key of Object.keys(canHaveAccumulator)) {\n        handleAccumulator(canHaveAccumulator[key]);\n      }\n    }\n\n    const stageType = Object.keys(stage)[0];\n    if (stageType && typeof stage[stageType] === 'object') {\n      const stageOptions = stage[stageType];\n      for (const key of Object.keys(stageOptions)) {\n        if (stageOptions[key] != null &&\n            stageOptions[key].$function != null &&\n            typeof stageOptions[key].$function.body === 'function') {\n          stageOptions[key].$function.body = stageOptions[key].$function.body.toString();\n        }\n      }\n    }\n\n    if (stage.$facet != null) {\n      for (const key of Object.keys(stage.$facet)) {\n        stringifyFunctionOperators(stage.$facet[key]);\n      }\n    }\n  }\n};\n\nfunction handleAccumulator(operator) {\n  if (operator == null || operator.$accumulator == null) {\n    return;\n  }\n\n  for (const key of ['init', 'accumulate', 'merge', 'finalize']) {\n    if (typeof operator.$accumulator[key] === 'function') {\n      operator.$accumulator[key] = String(operator.$accumulator[key]);\n    }\n  }\n}\n"],"mappings":"AAAA,YAAY;;AAEZA,MAAM,CAACC,OAAO,GAAG,SAASC,0BAA0BA,CAACC,QAAQ,EAAE;EAC7D,IAAI,CAACC,KAAK,CAACC,OAAO,CAACF,QAAQ,CAAC,EAAE;IAC5B;EACF;EAEA,KAAK,MAAMG,KAAK,IAAIH,QAAQ,EAAE;IAC5B,IAAIG,KAAK,IAAI,IAAI,EAAE;MACjB;IACF;IAEA,MAAMC,kBAAkB,GAAGD,KAAK,CAACE,MAAM,IAAIF,KAAK,CAACG,OAAO,IAAIH,KAAK,CAACI,WAAW;IAC7E,IAAIH,kBAAkB,IAAI,IAAI,EAAE;MAC9B,KAAK,MAAMI,GAAG,IAAIC,MAAM,CAACC,IAAI,CAACN,kBAAkB,CAAC,EAAE;QACjDO,iBAAiB,CAACP,kBAAkB,CAACI,GAAG,CAAC,CAAC;MAC5C;IACF;IAEA,MAAMI,SAAS,GAAGH,MAAM,CAACC,IAAI,CAACP,KAAK,CAAC,CAAC,CAAC,CAAC;IACvC,IAAIS,SAAS,IAAI,OAAOT,KAAK,CAACS,SAAS,CAAC,KAAK,QAAQ,EAAE;MACrD,MAAMC,YAAY,GAAGV,KAAK,CAACS,SAAS,CAAC;MACrC,KAAK,MAAMJ,GAAG,IAAIC,MAAM,CAACC,IAAI,CAACG,YAAY,CAAC,EAAE;QAC3C,IAAIA,YAAY,CAACL,GAAG,CAAC,IAAI,IAAI,IACzBK,YAAY,CAACL,GAAG,CAAC,CAACM,SAAS,IAAI,IAAI,IACnC,OAAOD,YAAY,CAACL,GAAG,CAAC,CAACM,SAAS,CAACC,IAAI,KAAK,UAAU,EAAE;UAC1DF,YAAY,CAACL,GAAG,CAAC,CAACM,SAAS,CAACC,IAAI,GAAGF,YAAY,CAACL,GAAG,CAAC,CAACM,SAAS,CAACC,IAAI,CAACC,QAAQ,CAAC,CAAC;QAChF;MACF;IACF;IAEA,IAAIb,KAAK,CAACc,MAAM,IAAI,IAAI,EAAE;MACxB,KAAK,MAAMT,GAAG,IAAIC,MAAM,CAACC,IAAI,CAACP,KAAK,CAACc,MAAM,CAAC,EAAE;QAC3ClB,0BAA0B,CAACI,KAAK,CAACc,MAAM,CAACT,GAAG,CAAC,CAAC;MAC/C;IACF;EACF;AACF,CAAC;AAED,SAASG,iBAAiBA,CAACO,QAAQ,EAAE;EACnC,IAAIA,QAAQ,IAAI,IAAI,IAAIA,QAAQ,CAACC,YAAY,IAAI,IAAI,EAAE;IACrD;EACF;EAEA,KAAK,MAAMX,GAAG,IAAI,CAAC,MAAM,EAAE,YAAY,EAAE,OAAO,EAAE,UAAU,CAAC,EAAE;IAC7D,IAAI,OAAOU,QAAQ,CAACC,YAAY,CAACX,GAAG,CAAC,KAAK,UAAU,EAAE;MACpDU,QAAQ,CAACC,YAAY,CAACX,GAAG,CAAC,GAAGY,MAAM,CAACF,QAAQ,CAACC,YAAY,CAACX,GAAG,CAAC,CAAC;IACjE;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}